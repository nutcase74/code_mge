!
!  trowe:test_rowechelon.o
!	echo $(LINK) $(LFLAGS) -o $@ $^ -lmath ;\
!	$(LINK) $(LFLAGS) -o $@ $^ -lmath 
!

program main
  use matrix
  implicit none
  integer, parameter :: dp=kind(1.0d0), n=8 
  real(dp), dimension(n,n) :: mat, imat 
  integer, dimension(n)    :: freevar
  integer :: row_space, nf

  row_space = 1

  mat(1,:) = (/ 0.27070255E+00,  0.45680443E-01,  0.38671793E-01,  0.65257775E-02, &
                0.47796200E+00,  0.80655006E-01,  0.68280286E-01,  0.11522144E-01 /)
  mat(2,:) = (/ 0.27849633E+00,  0.76607312E-02, -0.75953544E-01, -0.20892903E-02, &
                0.10596934E+01,  0.29149492E-01, -0.28900730E+00, -0.79498615E-02 /)
  mat(3,:) = (/ 0.12658924E+00,  0.34821508E-02,  0.75953546E-01,  0.20892905E-02, &
                0.48167883E+00,  0.13249770E-01,  0.28900730E+00,  0.79498622E-02 /)
  mat(4,:) = (/ 0.19335896E+00,  0.32628887E-01,  0.11601538E+00,  0.19577332E-01, &
                0.34140143E+00,  0.57610718E-01,  0.20484086E+00,  0.34566431E-01 /)
  mat(5,:) = (/ 0.42538972E+00,  0.71783552E-01, -0.11601538E+00, -0.19577332E-01, &
                0.75108315E+00,  0.12674358E+00, -0.20484086E+00, -0.34566431E-01 /)
  mat(6,:) = (/ 0.25317848E-01,  0.69643011E-03,  0.17722494E+00,  0.48750109E-02, &
                0.96335766E-01,  0.26499539E-02,  0.67435038E+00,  0.18549677E-01 /)
  mat(7,:) = (/-0.75953545E-01, -0.20892901E-02,  0.27849633E+00,  0.76607301E-02, &
               -0.28900731E+00, -0.79498607E-02,  0.10596935E+01,  0.29149489E-01 /)
  mat(8,:) = (/ 0.38671793E-01,  0.65257775E-02,  0.27070255E+00,  0.45680443E-01, &
                0.68280286E-01,  0.11522144E-01,  0.47796200E+00,  0.80655006E-01 /)


  call rowechelon(mat, n, n, imat, freevar, nf, row_space)
  print *," FREE VAR ",freevar

end program main

!  mat(1,:) = (/ 0.35952103E+00,  0.41938703E+00,  0.51360145E-01,  0.59912430E-01,  &
!                0.44353209E-01,  0.51738728E-01,  0.63361724E-02,  0.73912464E-02 /)
!  mat(2,:) = (/ 0.56496162E+00,  0.65903677E+00, -0.15408044E+00, -0.17973730E+00,  &
!                0.69697900E-01,  0.81303715E-01, -0.19008518E-01, -0.22173741E-01 /)
!  mat(3,:) = (/ 0.55910545E-01,  0.65328036E-01, -0.62122828E-02, -0.72586706E-02, &
!                0.46289595E+00,  0.54086547E+00, -0.51432883E-01, -0.60096163E-01 /)
!  mat(4,:) = (/ 0.15911975E+00,  0.16196480E+00,  0.22731392E-01,  0.23137829E-01, &
!                0.27450367E+00,  0.27941178E+00,  0.39214810E-01,  0.39915969E-01 /)
!  mat(5,:) = (/ 0.11365696E+00,  0.11568914E+00,  0.68194176E-01,  0.69413485E-01, &
!                0.19607405E+00,  0.19957985E+00,  0.11764443E+00,  0.11974791E+00 /)
!  mat(6,:) = (/ 0.39214363E-01,  0.39915405E-01,  0.27450056E+00,  0.27940785E+00, &
!                0.22731922E-01,  0.23138304E-01,  0.15912346E+00,  0.16196814E+00 /)
!  mat(7,:) = (/ 0.62122828E-02,  0.72586707E-02,  0.43485980E-01,  0.50810695E-01, &
!                0.51432884E-01,  0.60096163E-01,  0.36003018E+00,  0.42067314E+00 /)
!  mat(8,:) = (/ -0.18636848E-01, -0.21776012E-01,  0.68335111E-01,  0.79845377E-01, & 
!                -0.15429865E+00, -0.18028849E+00,  0.56576172E+00,  0.66105779E+00 /)


!mat(1,:) = (/ 0.54086547E+00,  0.46289595E+00, -0.60096163E-01, -0.51432883E-01, &
!               0.65328036E-01,  0.55910545E-01, -0.72586706E-02, -0.62122828E-02 /)
! mat(2,:) = (/ 0.42067314E+00,  0.36003018E+00,  0.60096164E-01,  0.51432884E-01, &
!               0.50810694E-01,  0.43485980E-01,  0.72586707E-02,  0.62122829E-02 /)
! mat(3,:) = (/ 0.27940785E+00,  0.27450056E+00,  0.39915407E-01,  0.39214365E-01, &
!               0.16196814E+00,  0.15912346E+00,  0.23138305E-01,  0.22731923E-01 /)
! mat(4,:) = (/ 0.43906947E+00,  0.43135802E+00, -0.11974622E+00, -0.11764310E+00, &
!               0.25452136E+00,  0.25005115E+00, -0.69414916E-01, -0.68195769E-01 /)
! mat(5,:) = (/ 0.19957703E+00,  0.19607182E+00,  0.11974622E+00,  0.11764310E+00, &
!               0.11569152E+00,  0.11365961E+00,  0.69414917E-01,  0.68195770E-01 /)
! mat(6,:) = (/ 0.51738728E-01,  0.44353209E-01,  0.73912464E-02,  0.63361724E-02, &
!               0.41938703E+00,  0.35952103E+00,  0.59912430E-01,  0.51360145E-01 /)
! mat(7,:) = (/ 0.81303715E-01,  0.69697900E-01, -0.22173741E-01, -0.19008518E-01, &
!               0.65903677E+00,  0.56496162E+00, -0.17973730E+00, -0.15408044E+00 /)
! mat(8,:) = (/ 0.20824475E+00,  0.20458731E+00, -0.23138305E-01, -0.22731923E-01, &
!               0.35923866E+00,  0.35292929E+00, -0.39915407E-01, -0.39214365E-01 /)
